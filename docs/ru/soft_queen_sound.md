# Настройка Queen Sound

Queen Sound предназначен для добавления дополнительных звуковых каналов в системе. Решение является достаточно емким, но весьма гибким и хорошо подходит для случаев создания полноценных звуковых систем квеста (оформление целой комнаты или большого гаджета).  

## Перечень оборудования

| Устройство                 |                         Фото                          | Комментарии                            |
|----------------------------|:-----------------------------------------------------:|----------------------------------------|
| 1. Сетевой фильтр          |  ![](../assets/photo/power-strip-2.jpg ':size=100')   |                                        |
| 2. Процессорный модуль     |                                                       |                                        |
| 2.1. Raspberry Pi          | ![](../assets/photo/raspberry_pi_3_1.jpg ':size=200') | модель: Raspberry Pi 3 model B или B+  |
| 2.2. Micro-SD card         |     ![](../assets/photo/microsd-1.jpg ':size=40')     | class 10, 8-32Gb                       |
| 2.3. RPi адаптер питания   |  ![](../assets/photo/ac_dc_adapter_1.jpg ':size=60')  | 5.1V, 2.5A                             |
| 2.4. USB аудио карта       |   ![](.//assets/photo/usb-audio-1.jpg ':size=100')    | модель: creative SB play 3             |
| 3. Аудио                   |                                                       |                                        |
| 3.1. Аудио-усилитель       |     ![](../assets/photo/tda7498.png ':size=100')      | модель: усилитель на базе чипа TDA7498 |
| 3.2. Блок питания 24VDC    |    ![](../assets/photo/12vdc-ps-1.jpg ':size=200')    | требования > 200W                      |
| 3.3. Mini-jack 3.5 в 2xRCA |  ![](../assets/photo/minijack_2rca.jpg ':size=100')   |                                        |
| 3.4. 2, 4 or 8 динамиков   |    ![](../assets/photo/speakers-1.jpg ':size=100')    |                                        |


Подключение динамиков, параметры оборудования и некоторые расчеты приводятся [здесь](hw_plug_sound), но если есть просто два динамика, то достаточно подключить просто по одному динамику на каждый из двух выходных каналов усилителя.

## Подготовка Raspberry Pi  

Необходимо подготовить Raspberry Pi. Для этого сначала нужно загрузить операционную систему, используя [инструкцию по заливке образа](rpi_image_upload), а затем установить нужный IP адрес сети, используя [эту инструкцию](rpi_ip_setup). После этого, используя [инструкцию по установке ПО](rpi_soft_install), следует скопировать в папку _/home/pi/queen_ последнюю версию программы _queen\_sound_. Также необходимо загрузить небходимые звуковые файлы.  

Далее необходимо установить атрибут файла _queen\_sound_ для возможности запуска. Для этого нужно правой кнопкой мыши кликнуть по файлу и в меню выбрать "Properties". Перейти на вкладку "Permissions" открывшегося диалога "File properties" и установить Execute = Anyone, затем нажать "Enter":  

![rpi_fileprops](../assets/screen/rpi_fileprops.jpg)

## Подключение и проверка

Для проигрывания видео создайте в _Queen Studio_ компонент типа "adapter" и установите у него hwtype=sound, а в качестве IP адреса нужно указать IP адрес Raspberry, на котором будет запущен _Queen Sound_, port=4455. Далее, запустив _Queen Room_, нужно убедиться, что связь с _Queen Sound_ установилась (адаптер стал зеленым), и двойным кликом вызвать меню, зайти в подменю "play" и выбрать нужный файл sound\_check.mp3 для проигрывания (файл должен быть скопирован заранее). Для Raspberry Pi _Queen Sound_ проигрывает sound\_check.mp3 на всех каналах (audio, hdmi, usb, ...), а для Windows только на устройствах, указанных в queen\_sound.cfg. Для Raspberry Pi файл конфигурации queen\_sound.cfg в принципе не нужен.  




